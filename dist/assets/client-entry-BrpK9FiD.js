const we="growi-plugin-remark-youtube",De="1.0.0",Te="GROWI plugin template for script",Le="MIT",Ee=["growi","growi-plugin"],$e="module",ke={dev:"vite",build:"tsc && vite build",preview:"vite preview"},He={react:"^18.3.1","react-dom":"^18.3.1","react-innertext":"^1.1.5",unified:"^11.0.5","unist-util-visit":"^5.0.0","vanilla-calendar-pro":"^2.9.10"},xe={"@types/react":"^18.3.3","@types/react-dom":"^18.3.0","@typescript-eslint/eslint-plugin":"^5.0.0","@typescript-eslint/parser":"^5.0.0","@vitejs/plugin-react":"^4.3.1",eslint:"^8.18.0","eslint-config-next":"^14.2.4","eslint-config-weseek":"^2.1.0","eslint-import-resolver-typescript":"^3.2.5","eslint-plugin-import":"^2.29.1","eslint-plugin-jest":"^27.1.0","eslint-plugin-react":"^7.30.1","eslint-plugin-react-hooks":"^4.6.0","eslint-plugin-regex":"^1.10.0",jest:"^29.7.0",typescript:"^5.5.2",vite:"^5.3.2"},Ye={schemaVersion:"4",types:["script"]},_e={name:we,version:De,description:Te,license:Le,keywords:Ee,type:$e,scripts:ke,dependencies:He,devDependencies:xe,growiPlugin:Ye},oe=function(e){if(e==null)return Pe;if(typeof e=="function")return _(e);if(typeof e=="object")return Array.isArray(e)?Ne(e):Ae(e);if(typeof e=="string")return Ie(e);throw new Error("Expected function, string, or object as test")};function Ne(e){const t=[];let n=-1;for(;++n<e.length;)t[n]=oe(e[n]);return _(s);function s(...a){let l=-1;for(;++l<t.length;)if(t[l].apply(this,a))return!0;return!1}}function Ae(e){const t=e;return _(n);function n(s){const a=s;let l;for(l in e)if(a[l]!==t[l])return!1;return!0}}function Ie(e){return _(t);function t(n){return n&&n.type===e}}function _(e){return t;function t(n,s,a){return!!(Fe(n)&&e.call(this,n,typeof s=="number"?s:void 0,a||void 0))}}function Pe(){return!0}function Fe(e){return e!==null&&typeof e=="object"&&"type"in e}const de=[],We=!0,G=!1,Oe="skip";function Be(e,t,n,s){let a;typeof t=="function"&&typeof n!="function"?(s=n,n=t):a=t;const l=oe(a),i=s?-1:1;r(e,void 0,[])();function r(o,d,c){const u=o&&typeof o=="object"?o:{};if(typeof u.type=="string"){const p=typeof u.tagName=="string"?u.tagName:typeof u.name=="string"?u.name:void 0;Object.defineProperty(y,"name",{value:"node ("+(o.type+(p?"<"+p+">":""))+")"})}return y;function y(){let p=de,v,S,$;if((!t||l(o,d,c[c.length-1]||void 0))&&(p=je(n(o,c)),p[0]===G))return p;if("children"in o&&o.children){const D=o;if(D.children&&p[0]!==Oe)for(S=(s?D.children.length:-1)+i,$=c.concat(D);S>-1&&S<D.children.length;){const be=D.children[S];if(v=r(be,S,$)(),v[0]===G)return v;S=typeof v[1]=="number"?v[1]:S+i}}return p}}}function je(e){return Array.isArray(e)?e:typeof e=="number"?[We,e]:e==null?de:[e]}function qe(e,t,n,s){let a,l,i;typeof t=="function"&&typeof n!="function"?(l=void 0,i=t,a=n):(l=t,i=n,a=s),Be(e,l,r,a);function r(o,d){const c=d[d.length-1],u=c?c.children.indexOf(o):void 0;return i(o,u,c)}}/*! name: vanilla-calendar-pro v2.9.10 | url: https://github.com/uvarov-frontend/vanilla-calendar-pro */var Ke=Object.defineProperty,V=Object.getOwnPropertySymbols,Re=Object.prototype.hasOwnProperty,ze=Object.prototype.propertyIsEnumerable,A=(e,t,n)=>t in e?Ke(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ce=(e,t)=>{for(var n in t||(t={}))Re.call(t,n)&&A(e,n,t[n]);if(V)for(var n of V(t))ze.call(t,n)&&A(e,n,t[n]);return e},m=(e,t,n)=>(A(e,typeof t!="symbol"?t+"":t,n),n);const Ge={calendar:"vanilla-calendar",calendarDefault:"vanilla-calendar_default",calendarMultiple:"vanilla-calendar_multiple",calendarMonth:"vanilla-calendar_month",calendarYear:"vanilla-calendar_year",calendarHidden:"vanilla-calendar_hidden",calendarToInput:"vanilla-calendar_to-input",calendarToInputTop:"vanilla-calendar_to-input_top",calendarToInputBottom:"vanilla-calendar_to-input_bottom",controls:"vanilla-calendar-controls",grid:"vanilla-calendar-grid",gridDisabled:"vanilla-calendar-grid_disabled",column:"vanilla-calendar-column",columnMonth:"vanilla-calendar-column_month",columnYear:"vanilla-calendar-column_year",header:"vanilla-calendar-header",headerContent:"vanilla-calendar-header__content",month:"vanilla-calendar-month",monthDisabled:"vanilla-calendar-month_disabled",year:"vanilla-calendar-year",yearDisabled:"vanilla-calendar-year_disabled",arrow:"vanilla-calendar-arrow",arrowPrev:"vanilla-calendar-arrow_prev",arrowNext:"vanilla-calendar-arrow_next",wrapper:"vanilla-calendar-wrapper",content:"vanilla-calendar-content",week:"vanilla-calendar-week",weekDay:"vanilla-calendar-week__day",weekDayWeekend:"vanilla-calendar-week__day_weekend",days:"vanilla-calendar-days",daysSelecting:"vanilla-calendar-days_selecting",months:"vanilla-calendar-months",monthsSelecting:"vanilla-calendar-months_selecting",monthsMonth:"vanilla-calendar-months__month",monthsMonthSelected:"vanilla-calendar-months__month_selected",monthsMonthDisabled:"vanilla-calendar-months__month_disabled",years:"vanilla-calendar-years",yearsSelecting:"vanilla-calendar-years_selecting",yearsYear:"vanilla-calendar-years__year",yearsYearSelected:"vanilla-calendar-years__year_selected",yearsYearDisabled:"vanilla-calendar-years__year_disabled",time:"vanilla-calendar-time",timeContent:"vanilla-calendar-time__content",timeHours:"vanilla-calendar-time__hours",timeMinutes:"vanilla-calendar-time__minutes",timeKeeping:"vanilla-calendar-time__keeping",timeRanges:"vanilla-calendar-time__ranges",timeRange:"vanilla-calendar-time__range",day:"vanilla-calendar-day",dayHoverFirst:"vanilla-calendar-day_hover-first",dayHoverLast:"vanilla-calendar-day_hover-last",dayHoverIntermediate:"vanilla-calendar-day_hover-intermediate",daySelectedFirst:"vanilla-calendar-day_selected-first",daySelectedLast:"vanilla-calendar-day_selected-last",daySelectedIntermediate:"vanilla-calendar-day_selected-intermediate",dayPopup:"vanilla-calendar-day__popup",dayBtn:"vanilla-calendar-day__btn",dayBtnPrev:"vanilla-calendar-day__btn_prev",dayBtnNext:"vanilla-calendar-day__btn_next",dayBtnToday:"vanilla-calendar-day__btn_today",dayBtnSelected:"vanilla-calendar-day__btn_selected",dayBtnHover:"vanilla-calendar-day__btn_hover",dayBtnDisabled:"vanilla-calendar-day__btn_disabled",dayBtnWeekend:"vanilla-calendar-day__btn_weekend",dayBtnHoliday:"vanilla-calendar-day__btn_holiday",weekNumbers:"vanilla-calendar-week-numbers",weekNumbersTitle:"vanilla-calendar-week-numbers__title",weekNumbersContent:"vanilla-calendar-week-numbers__content",weekNumber:"vanilla-calendar-week-number",isFocus:"vanilla-calendar-is-focus"},Ve=e=>`<div class="${e.controls}"><#ArrowPrev /><#ArrowNext /></div><div class="${e.grid}"><#Multiple><div class="${e.column}"><div class="${e.header}"><div class="${e.headerContent}"><#Month /><#Year /></div></div><div class="${e.wrapper}"><#WeekNumbers /><div class="${e.content}"><#Week /><#Days /></div></div></div><#/Multiple></div><#ControlTime />`,Ue=e=>`<div class="${e.header}"><div class="${e.headerContent}"><#Month /><#Year /></div></div><div class="${e.wrapper}"><div class="${e.content}"><#Months /></div></div>`,Ze=e=>`<div class="${e.header}"><#ArrowPrev /><div class="${e.headerContent}"><#Month /><#Year /></div><#ArrowNext /></div><div class="${e.wrapper}"><div class="${e.content}"><#Years /></div></div>`;class Xe{constructor(){var t;m(this,"isInit",!1),m(this,"isInputInit",!1),m(this,"input",!1),m(this,"type","default"),m(this,"months",2),m(this,"jumpMonths",1),m(this,"jumpToSelectedDate",!1),m(this,"toggleSelected",!0),m(this,"date",{min:"1970-01-01",max:"2470-12-31",today:new Date}),m(this,"settings",{lang:"en",iso8601:!0,range:{min:void 0,max:void 0,disablePast:!1,disableGaps:!1,edgesOnly:!1,disableAllDays:!1,disableWeekday:void 0,disabled:void 0,enabled:void 0},selection:{day:"single",month:!0,year:!0,time:!1,controlTime:"all",stepHours:1,stepMinutes:1,cancelableDay:!0},selected:{dates:void 0,month:void 0,year:void 0,holidays:void 0,time:void 0},visibility:{theme:"system",themeDetect:"html[data-theme]",monthShort:!0,weekNumbers:!1,weekend:!0,today:!0,disabled:!1,daysOutside:!0,positionToInput:"left"}}),m(this,"locale",{months:[],weekday:[]}),m(this,"sanitizer",n=>n),m(this,"actions",{clickDay:null,clickWeekNumber:null,clickMonth:null,clickYear:null,clickArrow:null,changeTime:null,changeToInput:null,getDays:null,getMonths:null,getYears:null,initCalendar:null,updateCalendar:null,destroyCalendar:null,showCalendar:null,hideCalendar:null}),m(this,"popups",{}),m(this,"CSSClasses",ce({},Ge)),m(this,"DOMTemplates",{default:(t=this.CSSClasses,`<div class="${t.header}"><#ArrowPrev /><div class="${t.headerContent}"><#Month /><#Year /></div><#ArrowNext /></div><div class="${t.wrapper}"><#WeekNumbers /><div class="${t.content}"><#Week /><#Days /></div></div><#ControlTime />`),multiple:Ve(this.CSSClasses),month:Ue(this.CSSClasses),year:Ze(this.CSSClasses)}),m(this,"HTMLElement"),m(this,"HTMLOriginalElement"),m(this,"HTMLInputElement"),m(this,"rangeMin"),m(this,"rangeMax"),m(this,"rangeDisabled"),m(this,"rangeEnabled"),m(this,"selectedDates"),m(this,"selectedHolidays"),m(this,"selectedMonth"),m(this,"selectedYear"),m(this,"selectedHours"),m(this,"selectedMinutes"),m(this,"selectedKeeping"),m(this,"selectedTime"),m(this,"currentType"),m(this,"correctMonths"),m(this,"viewYear"),m(this,"dateMin"),m(this,"dateMax")}}const M=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`,h=e=>new Date(`${e}T00:00:00`),b=e=>e.reduce((t,n)=>{if(n instanceof Date||typeof n=="number"){const s=n instanceof Date?n:new Date(n);t.push(s.toISOString().substring(0,10))}else n.match(/^(\d{4}-\d{2}-\d{2})$/g)?t.push(n):n.replace(/(\d{4}-\d{2}-\d{2}).*?(\d{4}-\d{2}-\d{2})/g,(s,a,l)=>{const i=h(a),r=h(l),o=new Date(i.getTime());for(;o<=r;o.setDate(o.getDate()+1))t.push(M(o));return s});return t},[]),k=()=>{const e=new Date;return new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().substring(0,10)},L=e=>e?{0:"12",13:"01",14:"02",15:"03",16:"04",17:"05",18:"06",19:"07",20:"08",21:"09",22:"10",23:"11"}[Number(e)]||String(e):"",w={notFoundSelector:e=>`${e} is not found, check the first argument passed to new VanillaCalendar.`,notInit:'The calendar has not been initialized, please initialize it using the "init()" method first.',notLocale:'You specified "define" for "settings.lang" but did not provide the required values for "locale.weekday" or "locale.months".',incorrectTheme:'Incorrect name of theme in "settings.visibility.theme".',incorrectTime:"The value of the time property can be: false, true, 12 or 24."},Je=e=>{var t;if(e.jumpToSelectedDate&&((t=e.settings.selected.dates)!=null&&t.length)&&e.settings.selected.month===void 0&&e.settings.selected.year===void 0){const a=h(b(e.settings.selected.dates)[0]);e.settings.selected.month=a.getMonth(),e.settings.selected.year=a.getFullYear()}const n=e.settings.selected.month!==void 0&&Number(e.settings.selected.month)>=0&&Number(e.settings.selected.month)<12,s=e.settings.selected.year!==void 0&&Number(e.settings.selected.year)>=0&&Number(e.settings.selected.year)<=9999;e.selectedMonth=n?Number(e.settings.selected.month):e.date.today.getMonth(),e.selectedYear=s?Number(e.settings.selected.year):e.date.today.getFullYear(),e.viewYear=e.selectedYear},Qe=e=>{var t,n,s;e.date.min==="today"&&(e.date.min=k()),e.date.max==="today"&&(e.date.max=k()),e.settings.range.min==="today"&&(e.settings.range.min=k()),e.settings.range.max==="today"&&(e.settings.range.max=k()),e.settings.range.min=e.settings.range.min?h(e.date.min)>=h(e.settings.range.min)?e.date.min:e.settings.range.min:e.date.min,e.settings.range.max=e.settings.range.max?h(e.date.max)<=h(e.settings.range.max)?e.date.max:e.settings.range.max:e.date.max;const a=e.settings.range.disablePast&&!e.settings.range.disableAllDays&&h(e.settings.range.min)<e.date.today;e.rangeMin=a||e.settings.range.disableAllDays?M(e.date.today):e.settings.range.min,e.rangeMax=e.settings.range.disableAllDays?M(e.date.today):e.settings.range.max,e.rangeDisabled=e.settings.range.disabled&&!e.settings.range.disableAllDays?b(e.settings.range.disabled):e.settings.range.disableAllDays?[e.rangeMin]:[],e.rangeDisabled.length>1&&e.rangeDisabled.sort((l,i)=>+new Date(l)-+new Date(i)),e.rangeEnabled=e.settings.range.enabled?b(e.settings.range.enabled):[],(t=e.rangeEnabled)!=null&&t[0]&&((n=e.rangeDisabled)!=null&&n[0])&&(e.rangeDisabled=e.rangeDisabled.filter(l=>!e.rangeEnabled.includes(l))),e.rangeEnabled.length>1&&e.rangeEnabled.sort((l,i)=>+new Date(l)-+new Date(i)),(s=e.rangeEnabled)!=null&&s[0]&&e.settings.range.disableAllDays&&(e.rangeMin=e.rangeEnabled[0],e.rangeMax=e.rangeEnabled[e.rangeEnabled.length-1])},et=e=>{var t,n;e.selectedDates=(t=e.settings.selected.dates)!=null&&t[0]?b(e.settings.selected.dates):[],e.selectedHolidays=(n=e.settings.selected.holidays)!=null&&n[0]?b(e.settings.selected.holidays):[]},tt=e=>{e.dateMin=e.settings.visibility.disabled?h(e.date.min):h(e.rangeMin),e.dateMax=e.settings.visibility.disabled?h(e.date.max):h(e.rangeMax)},nt=e=>{const t=e.settings.selection.time===!0||e.settings.selection.time===12;if(t||e.settings.selection.time===24){let n=!1;if(typeof e.settings.selected.time=="string"){const s=t?/^([0-9]|0[1-9]|1[0-2]):([0-5][0-9])|(AM|PM)/g:/^([0-1]?[0-9]|2[0-3]):([0-5][0-9])/g;e.settings.selected.time.replace(s,(a,l,i,r)=>(l&&i&&(n=!0,e.selectedHours=l,e.selectedMinutes=i),r&&t?e.selectedKeeping=r:t&&(e.selectedKeeping="AM"),""))}!n&&t?(e.selectedHours=L(String(e.date.today.getHours())),e.selectedMinutes=String(e.date.today.getMinutes()),e.selectedKeeping=Number(e.date.today.getHours())>=12?"PM":"AM"):n||(e.selectedHours=String(e.date.today.getHours()),e.selectedMinutes=String(e.date.today.getMinutes())),e.selectedHours=Number(e.selectedHours)<10?`0${Number(e.selectedHours)}`:`${e.selectedHours}`,e.selectedMinutes=Number(e.selectedMinutes)<10?`0${Number(e.selectedMinutes)}`:`${e.selectedMinutes}`,e.selectedTime=`${e.selectedHours}:${e.selectedMinutes}${e.selectedKeeping?` ${e.selectedKeeping}`:""}`}else if(e.settings.selection.time)throw new Error(w.incorrectTime)},at=e=>{e.correctMonths=e.type==="multiple"?e.months===1?2:e.months>12?12:e.months:1},ue=e=>{e.currentType=e.type,Je(e),Qe(e),et(e),tt(e),nt(e),at(e)},U=({arrowPrev:e,arrowNext:t,isPrevHidden:n,isNextHidden:s})=>{e.style.visibility=n?"hidden":"",t.style.visibility=s?"hidden":""},O=e=>{var t,n;if(e.currentType==="month")return;const s=(t=e.HTMLElement)==null?void 0:t.querySelector(`.${e.CSSClasses.arrowPrev}`),a=(n=e.HTMLElement)==null?void 0:n.querySelector(`.${e.CSSClasses.arrowNext}`);!s||!a||{default:()=>{const l=h(M(new Date(e.selectedYear,e.selectedMonth,1))),i=new Date(l.getTime()),r=new Date(l.getTime());i.setMonth(i.getMonth()-e.jumpMonths),r.setMonth(r.getMonth()+e.jumpMonths),e.settings.selection.year||(e.dateMin.setFullYear(l.getFullYear()),e.dateMax.setFullYear(l.getFullYear()));const o=!e.settings.selection.month||i.getFullYear()<e.dateMin.getFullYear()||i.getFullYear()===e.dateMin.getFullYear()&&i.getMonth()<e.dateMin.getMonth(),d=!e.settings.selection.month||r.getFullYear()>e.dateMax.getFullYear()||r.getFullYear()===e.dateMax.getFullYear()&&r.getMonth()>e.dateMax.getMonth();U({arrowPrev:s,arrowNext:a,isPrevHidden:o,isNextHidden:d})},year:()=>{U({arrowPrev:s,arrowNext:a,isPrevHidden:e.dateMin.getFullYear()&&e.viewYear-7<=e.dateMin.getFullYear(),isNextHidden:e.dateMax.getFullYear()&&e.viewYear+7>=e.dateMax.getFullYear()})}}[e.currentType==="multiple"?"default":e.currentType]()},me=(e,t)=>{if(!e)return null;const n=h(e),s=t?n.getDay()||7:n.getDay();n.setDate(n.getDate()+4-s);const a=new Date(n.getFullYear(),0,1),l=Math.ceil(((+n-+a)/864e5+1)/7);return{year:n.getFullYear(),week:l}};function B(e){if(!e||!e.getBoundingClientRect)return{top:0,bottom:0,left:0,right:0};const t=e.getBoundingClientRect(),n=document.documentElement;return{bottom:t.bottom,right:t.right,top:t.top+window.scrollY-n.clientTop,left:t.left+window.scrollX-n.clientLeft}}function st(){return{left:window.scrollX||document.documentElement.scrollLeft||0,top:window.scrollY||document.documentElement.scrollTop||0}}function j(){return{vw:Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),vh:Math.max(document.documentElement.clientHeight||0,window.innerHeight||0)}}function lt(e){const{top:t,left:n}=st(),{top:s,left:a}=B(e),{vh:l,vw:i}=j(),r=s-t,o=a-n;return{top:r,bottom:l-(r+e.clientHeight),left:o,right:i-(o+e.clientWidth)}}function ge(e,t,n=5){const s={top:!0,bottom:!0,left:!0,right:!0},a=[];if(!t||!e)return{canShow:s,parentPositions:a};const{bottom:l,top:i}=lt(e),{top:r,left:o}=B(e),{height:d,width:c}=t.getBoundingClientRect(),{vh:u,vw:y}=j(),p=y/2,v=u/2;return[{condition:r<v,position:"top"},{condition:r>v,position:"bottom"},{condition:o<p,position:"left"},{condition:o>p,position:"right"}].forEach(({condition:S,position:$})=>{S&&a.push($)}),Object.assign(s,{top:d<=i-n,bottom:d<=l-n,left:c<=o,right:c<=y-o}),{canShow:s,parentPositions:a}}function it(e,t){const n="left";if(!t||!e)return n;const{canShow:s,parentPositions:a}=ge(e,t),l=s.left&&s.right;return(l&&s.bottom?"center":l&&s.top?["top","center"]:Array.isArray(a)?[a[0]==="bottom"?"top":"bottom",...a.slice(1)]:a)||n}const I=(e,t,n,s)=>{if(e){const a=n==="auto"?it(e,t):n,l={top:-t.offsetHeight,bottom:e.offsetHeight,left:0,center:e.offsetWidth/2-t.offsetWidth/2,right:e.offsetWidth-t.offsetWidth},i=Array.isArray(a)?a[0]:"bottom",r=Array.isArray(a)?a[1]:a;i==="bottom"?(t.classList.remove(s.calendarToInputTop),t.classList.add(s.calendarToInputBottom)):(t.classList.remove(s.calendarToInputBottom),t.classList.add(s.calendarToInputTop));const{top:o,left:d}=B(e),c=o+l[i];let u=d+l[r];const{vw:y}=j();if(u+t.clientWidth>y){const p=window.innerWidth-document.body.clientWidth;u=y-t.clientWidth-p}else u<0&&(u=0);Object.assign(t.style,{left:`${u}px`,top:`${c}px`})}},rt=(e,t,n,s)=>{const a=e.CSSClasses.dayPopup,l=s.querySelector(`[data-calendar-day="${t}"]`);if(l&&(n!=null&&n.modifier&&l.classList.add(...n.modifier.trim().split(" ")),n==null?void 0:n.html)){const i=l.parentElement,r=document.createElement("div");r.className=a,r.innerHTML=e.sanitizer(n.html),i.appendChild(r),setTimeout(()=>{if(r){const{canShow:o}=ge(i,r),d=5;let c=i.offsetHeight,u=0;o.bottom||(c=-r.offsetHeight-d),o.left&&!o.right&&(u=i.offsetWidth-r.offsetWidth/2),!o.left&&o.right&&(u=r.offsetWidth/2),Object.assign(r.style,{left:`${u}px`,top:`${c}px`})}})}},ot=(e,t)=>{var n;e.popups&&((n=Object.entries(e.popups))==null||n.forEach(([s,a])=>rt(e,s,a,t)))},dt=(e,t,n,s,a)=>{const l=t[n].querySelector(`.${e.CSSClasses.dayBtn}`),i=me(l==null?void 0:l.dataset.calendarDay,e.settings.iso8601);if(!i)return;const r=s.cloneNode(!0);r.innerText=String(i.week),r.dataset.calendarYearWeek=String(i.year),a.appendChild(r)},ct=(e,t,n,s,a)=>{if(!e.settings.visibility.weekNumbers)return;s.textContent="";const l=document.createElement("b");l.className=e.CSSClasses.weekNumbersTitle,l.innerText="#",s.appendChild(l);const i=document.createElement("div");i.className=e.CSSClasses.weekNumbersContent,s.appendChild(i);const r=document.createElement("button");r.type="button",r.className=e.CSSClasses.weekNumber;const o=a.querySelectorAll(`.${e.CSSClasses.day}`),d=Math.ceil((t+n)/7);for(let c=0;c<d;c++)dt(e,o,c===0?6:7*c,r,i)},ut=(e,t,n)=>{var s,a,l,i,r;const o=(s=e.settings.range.disableWeekday)==null?void 0:s.includes(n),d=e.settings.range.disableAllDays&&!!((a=e.rangeEnabled)!=null&&a[0]);!o&&!d||(l=e.rangeEnabled)!=null&&l.includes(t)||(i=e.rangeDisabled)!=null&&i.includes(t)||(e.rangeDisabled.push(t),(r=e.rangeDisabled)==null||r.sort((c,u)=>+new Date(c)-+new Date(u)))},mt=(e,t,n,s,a,l,i)=>{var r,o,d;if((h(e.rangeMin)>h(l)||h(e.rangeMax)<h(l)||(r=e.rangeDisabled)!=null&&r.includes(l)||!e.settings.selection.month&&i||!e.settings.selection.year&&h(l).getFullYear()!==t)&&(s.classList.add(e.CSSClasses.dayBtnDisabled),s.tabIndex=-1),e.settings.visibility.today&&M(e.date.today)===l&&s.classList.add(e.CSSClasses.dayBtnToday),!e.settings.visibility.weekend||a!==0&&a!==6||s.classList.add(e.CSSClasses.dayBtnWeekend),(o=e.selectedHolidays)!=null&&o.includes(l)&&s.classList.add(e.CSSClasses.dayBtnHoliday),(d=e.selectedDates)!=null&&d.includes(l)&&(s.classList.add(e.CSSClasses.dayBtnSelected),e.selectedDates.length>1&&e.settings.selection.day==="multiple-ranged"&&(e.selectedDates[0]===l&&n.classList.add(e.CSSClasses.daySelectedFirst),e.selectedDates[e.selectedDates.length-1]===l&&n.classList.add(e.CSSClasses.daySelectedLast),e.selectedDates[0]!==l&&e.selectedDates[e.selectedDates.length-1]!==l&&n.classList.add(e.CSSClasses.daySelectedIntermediate))),e.settings.range.edgesOnly&&e.selectedDates.length>1&&e.settings.selection.day==="multiple-ranged"){const c=+new Date(e.selectedDates[0]),u=+new Date(e.selectedDates[e.selectedDates.length-1]),y=+new Date(l);y>c&&y<u&&(s.classList.add(e.CSSClasses.dayBtnSelected),n.classList.add(e.CSSClasses.daySelectedIntermediate))}},q=(e,t,n,s,a,l,i,r)=>{const o=document.createElement("div");o.className=e.CSSClasses.day;const d=document.createElement("button");d.className=`${e.CSSClasses.dayBtn}${r?` ${r}`:""}`,d.type="button",d.innerText=String(s),d.dataset.calendarDay=l,e.settings.visibility.weekNumbers&&(()=>{const c=me(l,e.settings.iso8601);c&&(d.dataset.calendarWeekNumber=String(c.week))})(),i?e.settings.visibility.daysOutside&&o.appendChild(d):o.appendChild(d),ut(e,l,a),mt(e,t,o,d,a,l,i),n.appendChild(o),e.actions.getDays&&e.actions.getDays(s,l,o,d,e)},gt=(e,t,n,s,a)=>{let l=new Date(n,s,0).getDate()-(a-1);const i=s===0?n-1:n,r=s===0?12:s<10?`0${s}`:s;for(let o=a;o>0;o--,l++){const d=`${i}-${r}-${l}`,c=h(d).getDay();q(e,n,t,l,c,d,!0,e.CSSClasses.dayBtnPrev)}},ht=(e,t,n,s,a)=>{for(let l=1;l<=n;l++){const i=new Date(s,a,l),r=M(i),o=i.getDay();q(e,s,t,l,o,r,!1,null)}},yt=(e,t,n,s,a,l)=>{const i=l+n,r=7*Math.ceil(i/7)-i,o=a+1===12?s+1:s,d=a+1===12?"01":a+2<10?`0${a+2}`:a+2;for(let c=1;c<=r;c++){const u=`${o}-${d}-${c<10?`0${c}`:String(c)}`,y=h(u).getDay();q(e,s,t,c,y,u,!0,e.CSSClasses.dayBtnNext)}},x=e=>{const t=e.HTMLElement.querySelectorAll(`.${e.CSSClasses.days}`),n=e.HTMLElement.querySelectorAll(`.${e.CSSClasses.weekNumbers}`),s=new Date(e.selectedYear,e.selectedMonth,1);t.forEach((a,l)=>{const i=new Date(s);i.setMonth(i.getMonth()+l);const r=i.getMonth(),o=i.getFullYear(),d=new Date(o,r,1),c=new Date(o,r+1,0).getDate(),u=e.settings.iso8601?(d.getDay()!==0?d.getDay():7)-1:d.getDay();e.settings.selection.day&&a.classList.add(e.CSSClasses.daysSelecting),a.textContent="",gt(e,a,o,r,u),ht(e,a,c,o,r),yt(e,a,c,o,r,u),ct(e,u,c,n[l],a),ot(e,a)})},pt=(e,t,n,s)=>{const a=new Date(s.setMonth(e.selectedMonth+n)).getMonth(),l=e.settings.selection.month===!1||e.settings.selection.month==="only-arrows";t.tabIndex=l?-1:0,t.classList.toggle(e.CSSClasses.monthDisabled,l),t.setAttribute("data-calendar-selected-month",String(a)),t.innerText=e.locale.months[a]},vt=(e,t,n,s)=>{const a=new Date(s.setFullYear(e.selectedYear,e.selectedMonth+n)).getFullYear(),l=e.settings.selection.year===!1||e.settings.selection.year==="only-arrows";t.tabIndex=l?-1:0,t.classList.toggle(e.CSSClasses.yearDisabled,l),t.setAttribute("data-calendar-selected-year",String(a)),t.innerText=String(a)},N=e=>{var t,n;const s=(t=e.HTMLElement)==null?void 0:t.querySelectorAll("[data-calendar-selected-month]"),a=(n=e.HTMLElement)==null?void 0:n.querySelectorAll("[data-calendar-selected-year]");if(!(s!=null&&s[0])&&(a!=null&&a[0]))return;const l=new Date(e.selectedYear,e.selectedMonth,1);s==null||s.forEach((i,r)=>pt(e,i,r,l)),a==null||a.forEach((i,r)=>vt(e,i,r,l))},P=(e,t)=>{const n=h(M(new Date(e.selectedYear,e.selectedMonth,1)));({prev:()=>n.setMonth(n.getMonth()-e.jumpMonths),next:()=>n.setMonth(n.getMonth()+e.jumpMonths)})[t](),[e.selectedMonth,e.selectedYear]=[n.getMonth(),n.getFullYear()],N(e),O(e),x(e)},Mt=e=>`<button type="button"class="${e.CSSClasses.arrow} ${e.CSSClasses.arrowPrev}"data-calendar-arrow="prev"></button>`,St=e=>`<button type="button"class="${e.CSSClasses.arrow} ${e.CSSClasses.arrowNext}"data-calendar-arrow="next"></button>`,ft=e=>`<button type="button"class="${e.CSSClasses.month}"data-calendar-selected-month></button>`,Ct=e=>`<button type="button"class="${e.CSSClasses.year}"data-calendar-selected-year></button>`,bt=e=>`<div class="${e.CSSClasses.week}"></div>`,wt=e=>`<div class="${e.CSSClasses.days}"></div>`,Dt=e=>`<div class="${e.CSSClasses.months}"></div>`,Tt=e=>`<div class="${e.CSSClasses.years}"></div>`,Lt=e=>e.settings.visibility.weekNumbers?`<div class="${e.CSSClasses.weekNumbers}"></div>`:"",Et=e=>e.settings.selection.time?`<div class="${e.CSSClasses.time}"></div>`:"",$t=Object.freeze(Object.defineProperty({__proto__:null,ArrowNext:St,ArrowPrev:Mt,ControlTime:Et,Days:wt,Month:ft,Months:Dt,Week:bt,WeekNumbers:Lt,Year:Ct,Years:Tt},Symbol.toStringTag,{value:"Module"})),T=(e,t)=>t.replace(/[\n\t]/g,"").replace(/<#(?!\/?Multiple)(.*?)>/g,(n,s)=>{const a=(l=s.replace(/[/\s\n\t]/g,""),$t[l]);var l;const i=a?a(e):"";return e.sanitizer(i)}).replace(/[\n\t]/g,""),kt=(e,t)=>t.replace(/<#Multiple>(.*?)<#\/Multiple>/g,(n,s)=>{let a="";for(let l=0;l<e.correctMonths;l++)a+=s;return e.sanitizer(a)}).replace(/[\n\t]/g,""),K=(e,t)=>{const{HTMLElement:n,CSSClasses:s,DOMTemplates:a,type:l,currentType:i,correctMonths:r}=e,o=(c,u)=>{if(!t)return;const y=n.querySelector(`.${s.controls}`);y&&n.removeChild(y),n.querySelector(`.${s.grid}`).classList.add(s.gridDisabled);const p=t.closest(`.${s.column}`);p.classList.add(c),p.innerHTML=T(e,u)},d={default:()=>{n.classList.add(s.calendarDefault),n.classList.remove(s.calendarMonth,s.calendarYear),n.innerHTML=T(e,a.default)},multiple:()=>{r&&(n.classList.add(s.calendarMultiple),n.classList.remove(s.calendarMonth,s.calendarYear),n.innerHTML=kt(e,T(e,a.multiple)))},month:()=>{l!=="multiple"?(n.classList.add(s.calendarMonth),n.classList.remove(s.calendarDefault,s.calendarYear),n.innerHTML=T(e,a.month)):o(s.columnMonth,a.month)},year:()=>{l!=="multiple"?(n.classList.add(s.calendarYear),n.classList.remove(s.calendarDefault,s.calendarMonth),n.innerHTML=T(e,a.year)):o(s.columnYear,a.year)}};n.classList.add(s.calendar),d[i]()},Ht=(e,t,n,s,a)=>{const l=t.cloneNode(!1);return l.className=`${e.CSSClasses.yearsYear}${n===a?` ${e.CSSClasses.yearsYearSelected}`:s?` ${e.CSSClasses.yearsYearDisabled}`:""}`,l.dataset.calendarYear=String(a),l.title=String(a),l.innerText=String(a),s&&(l.tabIndex=-1),l},R=(e,t)=>{const n=t!=null&&t.dataset.calendarSelectedYear?Number(t==null?void 0:t.dataset.calendarSelectedYear):e.selectedYear;e.currentType="year",K(e,t),N(e),O(e);const s=e.HTMLElement.querySelector(`.${e.CSSClasses.years}`);if(!e.settings.selection.year||!s)return;s.classList.add(e.CSSClasses.yearsSelecting);const a=e.type!=="multiple"||e.selectedYear===n?0:1,l=document.createElement("button");l.type="button";for(let i=e.viewYear-7;i<e.viewYear+8;i++){const r=i<e.dateMin.getFullYear()+a||i>e.dateMax.getFullYear(),o=Ht(e,l,n,r,i);s.appendChild(o),e.actions.getYears&&e.actions.getYears(i,o,e)}},xt=(e,t)=>{const n=t.target.closest(`.${e.CSSClasses.arrow}`);n&&(["default","multiple"].includes(e.currentType)?P(e,n.dataset.calendarArrow):e.currentType==="year"&&e.viewYear!==void 0&&(e.viewYear+={prev:-15,next:15}[n.dataset.calendarArrow],R(e,t.target)),e.actions.clickArrow&&e.actions.clickArrow(t,e))},Yt=(e,t)=>{var n;if(!e.settings.visibility.weekNumbers||!e.actions.clickWeekNumber)return;const s=t.target.closest(`.${e.CSSClasses.weekNumber}`),a=(n=e.HTMLElement)==null?void 0:n.querySelectorAll("[data-calendar-week-number]");if(!s||!a)return;const l=Number(s.innerText),i=Number(s.dataset.calendarYearWeek),r=Array.from(a).filter(o=>Number(o.dataset.calendarWeekNumber)===l);e.actions.clickWeekNumber(t,l,r,i,e)},he=e=>`${e.charAt(0).toUpperCase()}${e.substring(1,e.length)}`.replace(/\./,""),_t=(e,t)=>{const n=new Date(`1978-01-0${t+1}T00:00:00.000Z`).toLocaleString(e.settings.lang,{weekday:"short",timeZone:"UTC"});e.locale.weekday.push(he(n))},Nt=(e,t)=>{const n=new Date(`1978-${t+1<=9?`0${t+1}`:t+1}-01T00:00:00.000Z`).toLocaleString(e.settings.lang,{month:"long",timeZone:"UTC"});e.locale.months.push(he(n))},At=e=>{if(e.settings.lang!=="define"||!e.locale.weekday[6]||!e.locale.months[11]){if(e.settings.lang==="define")throw new Error(w.notLocale);e.locale.weekday=[],e.locale.months=[];for(let t=0;t<7;t++)_t(e,t);for(let t=0;t<12;t++)Nt(e,t)}},Z=e=>{if(e.type!=="multiple")return 0;const t=e.HTMLElement.querySelectorAll(`.${e.CSSClasses.column}`),n=Array.from(t).findIndex(s=>s.classList.contains(`${e.CSSClasses.columnMonth}`));return n>0?n:0},It=(e,t,n,s,a,l)=>{const i=t.cloneNode(!1);return i.className=`${e.CSSClasses.monthsMonth}${n===l?` ${e.CSSClasses.monthsMonthSelected}`:a?` ${e.CSSClasses.monthsMonthDisabled}`:""}`,i.title=s,i.innerText=`${e.settings.visibility.monthShort?s.substring(0,3):s}`,i.dataset.calendarMonth=String(l),a&&(i.tabIndex=-1),i},ye=(e,t)=>{var n,s;const a=t!=null&&t.dataset.calendarSelectedMonth?Number(t.dataset.calendarSelectedMonth):e.selectedMonth,l=(n=t==null?void 0:t.closest(`.${e.CSSClasses.column}`))==null?void 0:n.querySelector(`.${e.CSSClasses.year}`),i=l?Number(l.dataset.calendarSelectedYear):e.selectedYear;e.currentType="month",K(e,t),N(e);const r=(s=e.HTMLElement)==null?void 0:s.querySelector(`.${e.CSSClasses.months}`);if(!e.settings.selection.month||!r)return;r.classList.add(e.CSSClasses.monthsSelecting);const o=e.jumpMonths>1?e.locale.months.map((c,u)=>a-e.jumpMonths*u).concat(e.locale.months.map((c,u)=>a+e.jumpMonths*u)).filter(c=>c>=0&&c<=12):Array.from(Array(12).keys()),d=document.createElement("button");d.type="button";for(let c=0;c<12;c++){const u=e.locale.months[c],y=c<e.dateMin.getMonth()+Z(e)&&i<=e.dateMin.getFullYear()||c>e.dateMax.getMonth()+Z(e)&&i>=e.dateMax.getFullYear()||c!==a&&!o.includes(c),p=It(e,d,a,u,y,c);r.appendChild(p),e.actions.getMonths&&e.actions.getMonths(c,p,e)}},z=(e,t)=>e&&t?{0:{AM:"00",PM:"12"},1:{AM:"01",PM:"13"},2:{AM:"02",PM:"14"},3:{AM:"03",PM:"15"},4:{AM:"04",PM:"16"},5:{AM:"05",PM:"17"},6:{AM:"06",PM:"18"},7:{AM:"07",PM:"19"},8:{AM:"08",PM:"20"},9:{AM:"09",PM:"21"},10:{AM:"10",PM:"22"},11:{AM:"11",PM:"23"},12:{AM:"12",PM:"12"}}[Number(e)][t]:"",H=(e,t,n)=>e.querySelector(`.${t}${n?` input[name="${n}"]`:""}`),X=(e,t,n)=>{e.addEventListener("mouseover",()=>t.classList.add(n)),e.addEventListener("mouseout",()=>t.classList.remove(n))},f=(e,t,n,s)=>{({hours:()=>{e.selectedHours=n},minutes:()=>{e.selectedMinutes=n}})[s](),e.selectedTime=`${e.selectedHours}:${e.selectedMinutes}${e.selectedKeeping?` ${e.selectedKeeping}`:""}`,e.actions.changeTime&&e.actions.changeTime(t,e),e.input&&e.HTMLInputElement&&e.actions.changeToInput&&e.actions.changeToInput(t,e)},J=(e,t,n,s,a,l)=>{t.addEventListener("input",i=>{const r=i.target,o=Number(r.value),d=o<10?`0${o}`:`${o}`;if(a!=="hours"||l!==12)return n.value=d,void f(e,i,d,a);o<l&&o>0?(n.value=d,e.selectedKeeping="AM",s.innerText=e.selectedKeeping,f(e,i,d,a)):(o===0?(e.selectedKeeping="AM",s.innerText="AM"):(e.selectedKeeping="PM",s.innerText="PM"),n.value=L(r.value),f(e,i,L(r.value),a))})},Q=(e,t,n,s,a,l)=>{n.addEventListener("change",i=>{const r=i.target,o=Number(r.value),d=o<10?`0${o}`:`${o}`;a==="hours"&&l===12?r.value&&o<=l&&o>0?(r.value=d,t.value=z(d,e.selectedKeeping),f(e,i,d,a)):r.value&&o<24&&(o>l||o===0)?(o===0?(e.selectedKeeping="AM",s.innerText="AM"):(e.selectedKeeping="PM",s.innerText="PM"),r.value=L(r.value),t.value=d,f(e,i,L(r.value),a)):r.value=e.selectedHours:r.value&&o<=l&&o>=0?(r.value=d,t.value=d,f(e,i,d,a)):a==="hours"?r.value=e.selectedHours:a==="minutes"&&(r.value=e.selectedMinutes)})},Pt=(e,t,n)=>{t.addEventListener("click",s=>{e.selectedKeeping=t.innerText.includes("AM")?"PM":"AM",t.innerText=e.selectedKeeping,n.value=z(e.selectedHours,e.selectedKeeping),f(e,s,e.selectedHours,"hours")})},Ft=(e,t,n)=>{const s=n===24?23:n||12,a=H(t,e.CSSClasses.timeRange,"hours"),l=H(t,e.CSSClasses.timeRange,"minutes"),i=H(t,e.CSSClasses.timeHours,"hours"),r=H(t,e.CSSClasses.timeMinutes,"minutes"),o=t.querySelector(`.${e.CSSClasses.timeKeeping}`);X(a,i,e.CSSClasses.isFocus),X(l,r,e.CSSClasses.isFocus),J(e,a,i,o,"hours",s),J(e,l,r,o,"minutes",0),Q(e,a,i,o,"hours",s),Q(e,l,r,o,"minutes",59),o&&Pt(e,o,a)},ee=(e,t,n,s)=>`<label class="${t}"><input type="text"name="${e}"maxlength="2"value="${n}"${s?"disabled":""}></label>`,te=(e,t,n,s,a,l)=>`<label class="${t}"><input type="range"name="${e}"min="${n}"max="${s}"step="${a}"value="${l}"></label>`,Wt=e=>{const t=e.HTMLElement.querySelector(`.${e.CSSClasses.time}`);if(!t)return;const n=e.settings.selection.time===!0?12:e.settings.selection.time,s=e.settings.selection.controlTime==="range",[a,l]=[0,23],[i,r]=[0,59];t.innerHTML=e.sanitizer(`<div class="${e.CSSClasses.timeContent}">${ee("hours",e.CSSClasses.timeHours,e.selectedHours,s)}${ee("minutes",e.CSSClasses.timeMinutes,e.selectedMinutes,s)}${n===12?`<button type="button" class="${e.CSSClasses.timeKeeping}"${s?"disabled":""}>${e.selectedKeeping}</button>`:""}</div><div class="${e.CSSClasses.timeRanges}">${te("hours",e.CSSClasses.timeRange,a,l,e.settings.selection.stepHours,e.selectedKeeping?z(e.selectedHours,e.selectedKeeping):e.selectedHours)}${te("minutes",e.CSSClasses.timeRange,i,r,e.settings.selection.stepMinutes,e.selectedMinutes)}</div>`),Ft(e,t,n)},Ot=(e,t,n)=>{const s=document.createElement("b");t.textContent="";for(let a=0;a<n.length;a++){const l=n[a],i=s.cloneNode(!0);i.className=`${e.CSSClasses.weekDay}`,i.className=`${e.CSSClasses.weekDay}${e.settings.visibility.weekend&&e.settings.iso8601?a===5||a===6?` ${e.CSSClasses.weekDayWeekend}`:"":e.settings.visibility.weekend&&!e.settings.iso8601&&(a===0||a===6)?` ${e.CSSClasses.weekDayWeekend}`:""}`,i.innerText=`${l}`,t.appendChild(i)}},ne=e=>{const t=[...e.locale.weekday];t[0]&&(e.settings.iso8601&&t.push(t.shift()),e.HTMLElement.querySelectorAll(`.${e.CSSClasses.week}`).forEach(n=>Ot(e,n,t)))},pe=["light","dark","system"],Y={value:!1,set:()=>{Y.value=!0},check:()=>Y.value},ve=(e,t)=>pe.find(n=>{var s;return n!=="system"&&((s=e.getAttribute(t))==null?void 0:s.includes(n))}),C=(e,t)=>{e.dataset.calendarTheme=t},ae=(e,t)=>{var n;if(n=t,C(e.HTMLElement,n.matches?"dark":"light"),e.settings.visibility.theme!=="system"||Y.check())return;const s=a=>{const l=document.querySelectorAll(`.${e.CSSClasses.calendar}`);l==null||l.forEach(i=>C(i,a.matches?"dark":"light"))};t.addEventListener?t.addEventListener("change",s):t.addListener(s),Y.set()},Bt=(e,t,n)=>{new MutationObserver(s=>{for(let a=0;a<s.length;a++)if(s[a].attributeName===n){const l=ve(t,n);l&&C(e.HTMLElement,l);break}}).observe(t,{attributes:!0})},jt=(e,t)=>{const n=e.settings.visibility.themeDetect?document.querySelector(e.settings.visibility.themeDetect):null;if(!n)return void ae(e,t);const s=e.settings.visibility.themeDetect.replace(/^.*\[(.+)\]/g,(l,i)=>i),a=ve(n,s);a?(C(e.HTMLElement,a),Bt(e,n,s)):ae(e,t)},qt=e=>{if(!pe.includes(e.settings.visibility.theme))throw new Error(w.incorrectTheme);if(window.matchMedia("(prefers-color-scheme)").media==="not all")return void C(e.HTMLElement,"light");({light:()=>C(e.HTMLElement,"light"),dark:()=>C(e.HTMLElement,"dark"),system:()=>jt(e,window.matchMedia("(prefers-color-scheme: dark)"))})[e.settings.visibility.theme]()},E=e=>{const t={default:()=>{ne(e),x(e)},multiple:()=>{ne(e),x(e)},month:()=>ye(e),year:()=>R(e)};qt(e),At(e),K(e),N(e),O(e),Wt(e),t[e.currentType]()},g={self:null,rangeMin:void 0,rangeMax:void 0},se=()=>{var e;if(!((e=g.self)!=null&&e.HTMLElement))return;const{CSSClasses:t}=g.self;g.self.HTMLElement.querySelectorAll(`.${g.self.CSSClasses.dayBtnHover}`).forEach(n=>{var s;n.classList.remove(g.self.CSSClasses.dayBtnHover),(s=n.parentElement)==null||s.classList.remove(t.dayHoverIntermediate,t.dayHoverFirst,t.dayHoverLast)})},Kt=(e,t,n)=>{var s,a,l;if(!((s=g.self)!=null&&s.selectedDates))return;const i=M(e),{CSSClasses:r}=g.self;if((a=g.self.rangeDisabled)!=null&&a.includes(i))return;const o=(l=g.self.HTMLElement)==null?void 0:l.querySelectorAll(`[data-calendar-day="${i}"]`);o==null||o.forEach(d=>{var c;d.classList.add(r.dayBtnHover),(c=d.parentElement)==null||c.classList.add(r.dayHoverIntermediate)}),t==null||t.forEach(d=>{var c;return(c=d.parentElement)==null?void 0:c.classList.add(r.dayHoverFirst)}),n==null||n.forEach(d=>{var c;return(c=d.parentElement)==null?void 0:c.classList.add(r.dayHoverLast)})},F=e=>{var t;if(!e.target||!((t=g.self)!=null&&t.selectedDates))return;if(!e.target.closest(`.${g.self.CSSClasses.days}`))return void se();const n=e.target.closest("[data-calendar-day]");if(!n)return;const s=n.dataset.calendarDay,a=h(g.self.selectedDates[0]),l=h(s),i=g.self.HTMLElement.querySelectorAll(`[data-calendar-day="${g.self.selectedDates[0]}"]`),r=g.self.HTMLElement.querySelectorAll(`[data-calendar-day="${s}"]`),[o,d]=a<l?[i,r]:[r,i],[c,u]=a<l?[a,l]:[l,a];se();for(let y=new Date(c);y<=u;y.setDate(y.getDate()+1))Kt(y,o,d)},W=e=>{g.self&&e.key==="Escape"&&(g.self.selectedDates=[],g.self.HTMLElement.removeEventListener("mousemove",F),document.removeEventListener("keydown",W),E(g.self))},Rt=()=>{var e,t,n;if(!((t=(e=g.self)==null?void 0:e.selectedDates)!=null&&t[0])||!((n=g.self.rangeDisabled)!=null&&n[0]))return;const s=h(g.self.selectedDates[0]),[a,l]=g.self.rangeDisabled.map(i=>h(i)).reduce(([i,r],o)=>[s>=o?o:i,s<o&&r===null?o:r],[null,null]);a&&(g.self.rangeMin=M(new Date(a.setDate(a.getDate()+1)))),l&&(g.self.rangeMax=M(new Date(l.setDate(l.getDate()-1))))},Me=(e,t)=>{var n;if(t){const s=e.selectedDates.length===1&&e.selectedDates[0].includes(t);e.selectedDates=s&&!e.settings.selection.cancelableDay?[t,t]:s&&e.settings.selection.cancelableDay?[]:e.selectedDates.length>1?[t]:[...e.selectedDates,t],(n=e.selectedDates)==null||n.sort((a,l)=>+new Date(a)-+new Date(l))}e.settings.range.disableGaps&&(g.rangeMin=g.rangeMin?g.rangeMin:e.rangeMin,g.rangeMax=g.rangeMax?g.rangeMax:e.rangeMax),g.self=e,{set:()=>{e.HTMLElement.addEventListener("mousemove",F),document.addEventListener("keydown",W),e.settings.range.disableGaps&&Rt()},reset:()=>{const[s,a]=[e.selectedDates[0],e.selectedDates[e.selectedDates.length-1]];e.selectedDates=e.selectedDates[0]!==e.selectedDates[e.selectedDates.length-1]?e.settings.range.edgesOnly?[s,a]:b([`${s}:${a}`]):[e.selectedDates[0],e.selectedDates[0]],e.HTMLElement.removeEventListener("mousemove",F),document.removeEventListener("keydown",W),e.settings.range.disableGaps&&g.self&&(g.self.rangeMin=g.rangeMin,g.self.rangeMax=g.rangeMax)}}[e.selectedDates.length===1?"set":"reset"]()},le=(e,t,n)=>{if(!t.dataset.calendarDay)return;const s=t.dataset.calendarDay,a=t.classList.contains(e.CSSClasses.dayBtnSelected);if(a&&!e.settings.selection.cancelableDay)return;let l=!0;e.toggleSelected!==void 0&&(l=typeof e.toggleSelected=="function"?e.toggleSelected(e):e.toggleSelected),a&&!l||(e.selectedDates=a?e.selectedDates.filter(i=>i!==s):n?[...e.selectedDates,s]:[s])},zt=(e,t)=>{var n;const s=t.target,a=o=>s.closest(`.${o}`),l=a(e.CSSClasses.dayBtn);if(!e.settings.selection.day||!["single","multiple","multiple-ranged"].includes(e.settings.selection.day)||!l)return;({single:()=>le(e,l,!1),multiple:()=>le(e,l,!0),"multiple-ranged":()=>Me(e,l.dataset.calendarDay)})[e.settings.selection.day](),(n=e.selectedDates)==null||n.sort((o,d)=>+new Date(o)-+new Date(d)),e.actions.clickDay&&e.actions.clickDay(t,e),e.input&&e.HTMLInputElement&&e.HTMLElement&&e.actions.changeToInput&&e.actions.changeToInput(t,e);const i=a(e.CSSClasses.dayBtnPrev),r=a(e.CSSClasses.dayBtnNext);({prev:()=>P(e,"prev"),next:()=>P(e,"next"),default:()=>x(e)})[i?"prev":r?"next":"default"]()},ie=(e,t,n,s,a)=>{const l=e.HTMLElement.querySelectorAll(`.${e.CSSClasses.column}`),i=Array.from(l).findIndex(o=>o.classList.contains(t)),r=Number(l[i].querySelector(`.${n}`).getAttribute(a));return e.currentType==="month"&&i>=0?s-i:e.currentType==="year"&&e.selectedYear!==r?s-1:s},Gt=(e,t,n,s,a)=>{const l={year:()=>{var i,r;return(r=(i=e.actions).clickYear)==null?void 0:r.call(i,t,e)},month:()=>{var i,r;return(r=(i=e.actions).clickMonth)==null?void 0:r.call(i,t,e)}};({year:()=>{if(e.type==="multiple"){const i=ie(e,e.CSSClasses.columnYear,e.CSSClasses.year,Number(a.dataset.calendarYear),"data-calendar-selected-year"),r=e.selectedMonth<e.dateMin.getMonth()&&i<=e.dateMin.getFullYear(),o=e.selectedMonth>e.dateMax.getMonth()&&i>=e.dateMax.getFullYear(),d=i<e.dateMin.getFullYear(),c=i>e.dateMax.getFullYear();r||d?(e.selectedYear=e.dateMin.getFullYear(),e.selectedMonth=e.dateMin.getMonth()):o||c?(e.selectedYear=e.dateMax.getFullYear(),e.selectedMonth=e.dateMax.getMonth()):e.selectedYear=i}else e.selectedYear=Number(a.dataset.calendarYear)},month:()=>{if(e.type==="multiple"){const i=ie(e,e.CSSClasses.columnMonth,e.CSSClasses.month,Number(a.dataset.calendarMonth),"data-calendar-selected-month"),r=a.closest(`.${s.column}`).querySelector(`.${e.CSSClasses.year}`);e.selectedYear=Number(r.dataset.calendarSelectedYear);const o=i<e.dateMin.getMonth()&&e.selectedYear<=e.dateMin.getFullYear(),d=i>e.dateMax.getMonth()&&e.selectedYear>=e.dateMax.getFullYear();e.selectedMonth=o?e.dateMin.getMonth():d?e.dateMax.getMonth():i}else e.selectedMonth=Number(a.dataset.calendarMonth)}})[n](),l[n](),e.currentType=e.type,E(e)},re=(e,t,n,s)=>{if(!e.settings.selection[n])return;const a=t.target,l=c=>a.closest(`.${c}`),i=l(s.header),r=l(s.item),o=l(e.CSSClasses.grid),d=l(e.CSSClasses.column);e.currentType!==n&&i?{year:()=>R(e,a),month:()=>ye(e,a)}[n]():r?Gt(e,t,n,s,r):(e.currentType===n&&i||e.type==="multiple"&&e.currentType===n&&o&&!d)&&(e.currentType=e.type,E(e))},Se=e=>{const t=n=>{xt(e,n),Yt(e,n),zt(e,n),re(e,n,"month",{header:e.CSSClasses.month,item:e.CSSClasses.monthsMonth,column:e.CSSClasses.columnMonth}),re(e,n,"year",{header:e.CSSClasses.year,item:e.CSSClasses.yearsYear,column:e.CSSClasses.columnYear})};return e.HTMLElement.addEventListener("click",t),()=>e.HTMLElement.removeEventListener("click",t)},fe=(e,{year:t,month:n,dates:s,holidays:a,time:l}={})=>{var i;const r=ce({},e.settings.selected);e.settings.selected.year=t?r.year:e.selectedYear,e.settings.selected.month=n?r.month:e.selectedMonth,e.settings.selected.holidays=a?r.holidays:e.selectedHolidays,e.settings.selected.time=l?r.time:e.selectedTime,e.settings.selected.dates=s==="only-first"&&((i=e.selectedDates)!=null&&i[0])?[e.selectedDates[0]]:s===!0?r.dates:e.selectedDates,ue(e),E(e),e.settings.selected=r,e.settings.selection.day==="multiple-ranged"&&s&&Me(e)},Ce=(e,t=!0)=>{e.isInputInit=!0;const n=document.createElement("div");return n.className=`${e.CSSClasses.calendar} ${e.CSSClasses.calendarToInput} ${e.CSSClasses.calendarHidden}`,e.HTMLElement=n,document.body.appendChild(e.HTMLElement),e.HTMLElement.style.visibility="hidden",t&&queueMicrotask(()=>{I(e.HTMLInputElement,n,e.settings.visibility.positionToInput,e.CSSClasses),e.HTMLElement.style.visibility="visible",e.show()}),fe(e,{year:!0,month:!0,dates:!0,holidays:!0,time:!0}),e.actions.initCalendar&&e.actions.initCalendar(e),Se(e)},Vt=e=>{const t=[];e.HTMLInputElement=e.HTMLElement;const n=()=>I(e.HTMLInputElement,e.HTMLElement,e.settings.visibility.positionToInput,e.CSSClasses),s=i=>{i.key==="Escape"&&(e!=null&&e.HTMLInputElement&&(e!=null&&e.HTMLElement)&&e.hide(),document.removeEventListener("keydown",s))},a=i=>{var r;e&&i.target!==e.HTMLInputElement&&!((r=e.HTMLElement)!=null&&r.contains(i.target))&&(e.HTMLInputElement&&e.HTMLElement&&e.hide(),window.removeEventListener("resize",n),document.removeEventListener("click",a,{capture:!0}))},l=()=>{e.isInputInit?(I(e.HTMLInputElement,e.HTMLElement,e.settings.visibility.positionToInput,e.CSSClasses),e.HTMLElement.style.visibility="visible",e.show()):t.push(Ce(e)),window.addEventListener("resize",n),document.addEventListener("click",a,{capture:!0}),document.addEventListener("keydown",s)};return e.HTMLInputElement.addEventListener("click",l),e.HTMLInputElement.addEventListener("focus",l),()=>{t.forEach(i=>i())}},Ut=(e,{year:t,month:n,dates:s,holidays:a,time:l}={})=>{if(!e.isInit)throw new Error(w.notInit);e.input&&!e.isInputInit&&Ce(e,!1),fe(e,{year:t,month:n,dates:s,holidays:a,time:l}),e.actions.updateCalendar&&e.actions.updateCalendar(e)},Zt=e=>{var t,n,s,a,l,i;if(!e.isInit)throw new Error(w.notInit);e.input?((n=(t=e.HTMLElement)==null?void 0:t.parentElement)==null||n.removeChild(e.HTMLElement),(a=(s=e.HTMLInputElement)==null?void 0:s.replaceWith)==null||a.call(s,e.HTMLOriginalElement),e.HTMLInputElement=void 0):(i=(l=e.HTMLElement)==null?void 0:l.replaceWith)==null||i.call(l,e.HTMLOriginalElement),e.HTMLElement=e.HTMLOriginalElement,e.actions.destroyCalendar&&e.actions.destroyCalendar(e)};class Xt extends Xe{constructor(t,n){if(super(),m(this,"init",()=>{return(a=this).HTMLOriginalElement=a.HTMLElement.cloneNode(!0),a.isInit=!0,a.input?Vt(a):(ue(a),E(a),a.actions.initCalendar&&a.actions.initCalendar(a),Se(a));var a}),m(this,"update",a=>Ut(this,a)),m(this,"destroy",()=>Zt(this)),m(this,"show",()=>{var a;(a=this).currentType?(a.HTMLElement.classList.remove(a.CSSClasses.calendarHidden),a.actions.showCalendar&&a.actions.showCalendar(a)):a.HTMLElement.click()}),m(this,"hide",()=>{var a;(a=this).currentType&&(a.HTMLElement.classList.add(a.CSSClasses.calendarHidden),a.actions.hideCalendar&&a.actions.hideCalendar(a))}),this.HTMLElement=typeof t=="string"?document.querySelector(t):t,!this.HTMLElement)throw new Error(w.notFoundSelector(t));if(!n)return;const s=(a,l)=>{Object.keys(l).forEach(i=>{typeof a[i]!="object"||typeof l[i]!="object"||l[i]instanceof Date?a[i]=l[i]:s(a[i],l[i])})};s(this,n)}}const Jt=function(){return e=>{qe(e,n=>{const s=n;try{if(s.type==="leafGrowiPluginDirective"&&s.name==="calendar"){const[a,l]=Object.keys(s.attributes),i=s.attributes.lang||"en_US",r=s.attributes.separator||"/";s.type="html",s.value='<div id="calendar"></div>',console.log(a,l,i);let o=!1;const d=setInterval(()=>{document.querySelector("#calendar")!=null&&(new Xt("#calendar",{settings:{lang:i,selected:{month:isNaN(a)?new Date().getMonth():parseInt(a)-1,year:isNaN(l)?new Date().getFullYear():parseInt(l)}},actions:{async clickDay(u,y){if(o)return;o=!0;const p=y.selectedDates[0].replaceAll(/-/g,r),v=await t();location.href=`${v}${p}`}}}).init(),clearInterval(d))},100)}}catch(a){s.type="html",s.value=`<div style="color: red;">Error: ${a.message}</div>`}});const t=async()=>{if(location.pathname==="/")return"/";const n=location.pathname.replace(/\//,""),a=await(await fetch(`/_api/v3/page?pageId=${n}`)).json(),{path:l}=a.page;return`${l}/`}}},Qt=()=>{if(growiFacade==null||growiFacade.markdownRenderer==null)return;const{optionsGenerators:e}=growiFacade.markdownRenderer;e.customGenerateViewOptions=(...t)=>{console.log(e);const n=e.generateViewOptions(...t);return n.remarkPlugins.push(Jt),n}},en=()=>{};window.pluginActivators==null&&(window.pluginActivators={});window.pluginActivators[_e.name]={activate:Qt,deactivate:en};
